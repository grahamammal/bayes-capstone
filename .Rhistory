# Load packages
library(ggplot2)
library(dplyr)
library(janitor)
library(reshape2)
library(tidyr)
library(rstan)
library(rstanarm)
library(bayesplot)
library(loo)
sleep <- read.csv("https://www.macalester.edu/~ajohns24/Data/SleepStudy.csv")
dim(sleep)
names(sleep)
head(sleep)
summary(sleep)
set.seed(454)
heir_model_1 <- stan_glm(Reaction ~ 1,
data = sleep,
family = gaussian,
chains = 4, iter = 2*5000)
heir_model_2  <- stan_glmer(
Reaction ~ (1 | Subject),
data = sleep, family = gaussian,
chains = 4, iter = 2*5000)
heir_model_3 <- stan_glmer(
Reaction ~ Days + (Days | Subject),
data = sleep, family = gaussian,
chains = 4, iter = 2*5000, refresh = 0)
library(ggplot2)
library(dplyr)
library(rstan)
library(rstanarm)
library(bayesplot)
library(loo)
library(tidyr)
library(ggridges)
candy <- fivethirtyeight::candy_rankings
dim(candy)
names(candy)
head(candy)
summary(candy)
set.seed(454)
model_1 <- stan_glm(winpercent ~ sugarpercent,
data = candy,
family = gaussian,
chains = 4, iter = 2*5000, refresh = FALSE)
model_2 <- stan_glm(winpercent ~ sugarpercent + pricepercent,
data = candy,
family = gaussian,
chains = 4, iter = 2*5000, refresh = FALSE)
model_3 <- stan_glm(winpercent ~ chocolate + fruity + caramel + peanutyalmondy + nougat + crispedricewafer + hard + bar + pluribus,
data = candy,
family = gaussian,
chains = 4, iter = 2*5000, refresh = FALSE)
model_4 <- stan_glm(winpercent ~ chocolate + fruity + caramel + peanutyalmondy + nougat + crispedricewafer + hard + bar + pluribus + sugarpercent + pricepercent,
data = candy,
family = gaussian,
chains = 4, iter = 2*5000, refresh = FALSE)
pp_check(model_1)
pp_check(model_1)
pp_check(model_2)
pp_check(model_3)
pp_check(model_4)
mcmc_trace(model_1)
mcmc_trace_dens(model_1)
mcmc_trace_density(model_1)
mcmc_density(model_1)
mcmc_dens(model_1)
pp_check(model_1)
pp_check(model_2)
pp_check(model_3)
pp_check(model_4)
mcmc_dens(model_1)
mcmc_dens(model_2)
mcmc_dens(model_3)
mcmc_dens(model_4)
mcmc_trace(model_1)
mcmc_trace(model_2)
mcmc_trace(model_3)
mcmc_trace(model_4)
# simulations are somewhat but not super stable. There are a few noticeable outliers in every model, as well as a relatively wide range of packed simulations. They seem to roughly fit, though go a little high overall.
library(ggplot2)
library(dplyr)
library(rstan)
library(rstanarm)
library(bayesplot)
library(loo)
library(tidyr)
library(ggridges)
pp_check(model_1)
pp_check(model_2)
pp_check(model_3)
pp_check(model_4)
mcmc_trace(model_1)
mcmc_trace(model_2)
mcmc_trace(model_3)
mcmc_trace(model_4)
# simulations are somewhat but not super stable. There are a few noticeable outliers in every model, as well as a relatively wide range of packed simulations. They seem to roughly fit, though go a little high overall.
